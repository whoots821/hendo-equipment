<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Hendo Equipment | Attachments & Pricing</title>

<style>
:root{
  --bg:#f4f6f4;--panel:#fff;--panelAlt:#eef2ee;--text:#0f172a;
  --muted:#475569;--border:#d1d5db;--accent:#6b7f3a;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text)}
.container{max-width:1200px;margin:0 auto;padding:16px}

header{background:#fff;border-bottom:4px solid var(--accent)}
.headerRow{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px}
.brand h1{margin:0;font-size:22px}
.badgeRow{display:flex;gap:8px;margin-top:6px;flex-wrap:wrap}
.badge{padding:6px 10px;border-radius:999px;background:var(--panelAlt);
  border:1px solid var(--border);font-size:12px;font-weight:900}

.btn{padding:10px 14px;border-radius:10px;border:1px solid var(--border);
  background:#fff;font-weight:900;cursor:pointer;text-decoration:none;display:inline-block}
.btnPrimary{background:var(--accent);color:#fff;border:none}

.layout{display:grid;grid-template-columns:260px 1fr;gap:16px;margin-top:16px}
@media(max-width:900px){.layout{grid-template-columns:1fr}}

.sidebar{background:#fff;border:1px solid var(--border);border-radius:14px;padding:12px}
.sideTitle{font-weight:900;color:var(--accent);margin-bottom:8px}

.machineTabs button,
.catBtn{
  width:100%;text-align:left;padding:10px;border-radius:8px;
  border:1px solid var(--border);background:#fff;font-weight:900;
  cursor:pointer;margin-bottom:6px
}
.machineTabs button.active,
.catBtn.active{background:var(--panelAlt);border-color:var(--accent)}

.content{background:#fff;border:1px solid var(--border);border-radius:14px;padding:14px}

.pageTitle{display:flex;flex-direction:column;gap:4px;margin-bottom:10px}
.pageTitle h2{margin:0;font-size:18px}
.small{font-size:12px;color:var(--muted)}

.tilesGrid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:12px;
  margin-top:12px;
}
.tile{
  border:1px solid var(--border);
  border-radius:14px;
  background:#fff;
  overflow:hidden;
}
.tileHead{
  padding:12px;
  background:var(--panelAlt);
  border-bottom:1px solid var(--border);
}
.tileHead .name{font-weight:1000}
.tileBody{padding:12px;display:grid;gap:10px}
.filters{display:flex;gap:10px;flex-wrap:wrap}
.field label{font-size:12px;font-weight:900;color:var(--muted)}
select{padding:10px;border-radius:8px;border:1px solid var(--border);min-width:160px}

.priceBig{font-size:22px;font-weight:1100}
footer{margin-top:24px;border-top:1px solid var(--border);background:#fff}
</style>
</head>

<body>
<header>
  <div class="container headerRow">
    <div class="brand">
      <h1>Hendo Equipment</h1>
      <div class="badgeRow">
        <span class="badge">ðŸ‡ºðŸ‡¸ USA Made</span>
        <span class="badge">Veteran Owned & Operated</span>
      </div>
    </div>
    <div>
      <a class="btn btnPrimary" href="tel:+18286990157">(828) 699-0157</a>
    </div>
  </div>
</header>

<main class="container">
  <section class="layout">
    <aside class="sidebar">
      <div class="sideTitle">Machine</div>
      <div class="machineTabs" id="machineTabs"></div>

      <div class="sideTitle">Categories</div>
      <div id="catList"></div>
    </aside>

    <section class="content">
      <div class="pageTitle">
        <h2 id="categoryTitle">Select a category</h2>
        <div class="small" id="categoryHint">Choose a machine + category. Then use duty + width dropdowns â€” price updates instantly.</div>
        <div class="small" id="status"></div>
      </div>

      <div id="tiles" class="tilesGrid"></div>
    </section>
  </section>
</main>

<footer>
  <div class="container small">
    Â© Hendo Equipment â€¢ Hendersonville, NC
  </div>
</footer>

<script>
/* =========================================================
   OPTION A: INLINE DATA (NO JSON FILE, NO UPLOAD TO /data)
   Excel-driven catalog is embedded below.
   All_Items is not included here.
   ========================================================= */

/* ---------- SETTINGS ---------- */
const QUOTE_EMAIL = "whoots821@gmail.com"; // change if you want

/* ---------- INLINE CATALOG (from Excel tabs) ---------- */
const CATALOG_BY_TAB = {
  "4N1 BUCKET MINI": {
    "category": "4N1 BUCKET MINI",
    "items": [
      {
        "name": "MINI 4-N-1",
        "variants": [
          { "sku": "MM4N1-36", "price": 2965, "duty": "Heavy Duty", "width": 36 },
          { "sku": "MM4N1-42", "price": 3065, "duty": "Heavy Duty", "width": 42 }
        ],
        "options": { "duty": ["Heavy Duty"], "width": [36, 42] },
        "lookup": {
          "Heavy Duty|36": { "sku": "MM4N1-36", "price": 2965, "duty": "Heavy Duty", "width": 36 },
          "Heavy Duty|42": { "sku": "MM4N1-42", "price": 3065, "duty": "Heavy Duty", "width": 42 }
        }
      }
    ]
  },
  "FORESTRY DISC MULCHER": {
    "category": "FORESTRY DISC MULCHER",
    "items": [
      {
        "name": "DISC MULCHER (STANDARD FLOW)",
        "variants": [
          { "sku": "FDM-60SF", "price": 24750, "duty": "Standard", "width": 60 }
        ],
        "options": { "duty": ["Standard"], "width": [60] },
        "lookup": {
          "Standard|60": { "sku": "FDM-60SF", "price": 24750, "duty": "Standard", "width": 60 }
        }
      },
      {
        "name": "DISC MULCHER (HIGH FLOW)",
        "variants": [
          { "sku": "FDM-60HF", "price": 26950, "duty": "High Flow", "width": 60 }
        ],
        "options": { "duty": ["High Flow"], "width": [60] },
        "lookup": {
          "High Flow|60": { "sku": "FDM-60HF", "price": 26950, "duty": "High Flow", "width": 60 }
        }
      }
    ]
  },
  "EXCAVATOR CUTTER": {
    "category": "EXCAVATOR CUTTER",
    "items": [
      {
        "name": "EXCAVATOR TREE CUTTER",
        "variants": [
          { "sku": "EXC-TC", "price": 12950, "duty": "Standard", "width": 0 }
        ],
        "options": { "duty": ["Standard"], "width": [0] },
        "lookup": {
          "Standard|0": { "sku": "EXC-TC", "price": 12950, "duty": "Standard", "width": 0 }
        }
      }
    ]
  },
  "4N1 BUCKET": {
    "category": "4N1 BUCKET",
    "items": [
      {
        "name": "4-N-1",
        "variants": [
          { "sku": "SV4N1-72", "price": 4950, "duty": "Severe Duty", "width": 72 },
          { "sku": "SV4N1-78", "price": 5100, "duty": "Severe Duty", "width": 78 },
          { "sku": "SV4N1-81", "price": 5250, "duty": "Severe Duty", "width": 81 },
          { "sku": "SV4N1-84", "price": 5400, "duty": "Severe Duty", "width": 84 }
        ],
        "options": { "duty": ["Severe Duty"], "width": [72, 78, 81, 84] },
        "lookup": {
          "Severe Duty|72": { "sku": "SV4N1-72", "price": 4950, "duty": "Severe Duty", "width": 72 },
          "Severe Duty|78": { "sku": "SV4N1-78", "price": 5100, "duty": "Severe Duty", "width": 78 },
          "Severe Duty|81": { "sku": "SV4N1-81", "price": 5250, "duty": "Severe Duty", "width": 81 },
          "Severe Duty|84": { "sku": "SV4N1-84", "price": 5400, "duty": "Severe Duty", "width": 84 }
        }
      },
      {
        "name": "4-N-1 W/TEETH",
        "variants": [
          { "sku": "SV4N1T-72", "price": 5250, "duty": "Severe Duty", "width": 72 },
          { "sku": "SV4N1T-78", "price": 5400, "duty": "Severe Duty", "width": 78 },
          { "sku": "SV4N1T-81", "price": 5550, "duty": "Severe Duty", "width": 81 },
          { "sku": "SV4N1T-84", "price": 5700, "duty": "Severe Duty", "width": 84 }
        ],
        "options": { "duty": ["Severe Duty"], "width": [72, 78, 81, 84] },
        "lookup": {
          "Severe Duty|72": { "sku": "SV4N1T-72", "price": 5250, "duty": "Severe Duty", "width": 72 },
          "Severe Duty|78": { "sku": "SV4N1T-78", "price": 5400, "duty": "Severe Duty", "width": 78 },
          "Severe Duty|81": { "sku": "SV4N1T-81", "price": 5550, "duty": "Severe Duty", "width": 81 },
          "Severe Duty|84": { "sku": "SV4N1T-84", "price": 5700, "duty": "Severe Duty", "width": 84 }
        }
      }
    ]
  },

  /* NOTE:
     For brevity in this inline example, only a subset of tabs/items is embedded.
     To embed ALL tabs/items, paste the rest of your catalog here the same way.
     If you want, upload your Excel again and Iâ€™ll output a FULL inline version containing every item. */
};

/* ---------- helpers ---------- */
const escAttr = s => String(s ?? "").replace(/"/g,'&quot;').replace(/</g,'&lt;');
const norm = s => String(s ?? "").toLowerCase().trim();
const money = n => {
  const num = Number(n);
  if (!Number.isFinite(num)) return "â€”";
  return "$" + Math.round(num).toLocaleString();
};
const uniq = arr => [...new Set((arr||[]).filter(v => v !== undefined && v !== null && v !== ""))];
const numericSort = arr => uniq(arr).slice().sort((a,b)=>Number(a)-Number(b));

/* ---------- machine mapping ---------- */
function inferMachine(categoryName){
  const n = norm(categoryName);
  if (n.includes("tractor")) return "Tractor";
  if (n.includes("excavator")) return "Excavator";
  if (n.includes("mini")) return "Mini Skid Steer";
  return "Skid/Track Loader";
}

/* ---------- DOM ---------- */
const machineTabs = document.getElementById("machineTabs");
const catList = document.getElementById("catList");
const tilesEl = document.getElementById("tiles");
const statusEl = document.getElementById("status");
const categoryTitle = document.getElementById("categoryTitle");
const categoryHint = document.getElementById("categoryHint");

/* ---------- normalize categories ---------- */
const MACHINES = ["Skid/Track Loader","Mini Skid Steer","Tractor","Excavator"];
const CATEGORIES = Object.entries(CATALOG_BY_TAB).map(([tabName, obj]) => {
  const label = obj?.category || tabName;
  return {
    id: tabName,
    label,
    machine: inferMachine(label),
    items: Array.isArray(obj?.items) ? obj.items : []
  };
}).sort((a,b)=>a.label.localeCompare(b.label));

/* ---------- state ---------- */
let machine = MACHINES.find(m => CATEGORIES.some(c => c.machine === m)) || "Skid/Track Loader";
let category = null;

/* ---------- variant lookup ---------- */
function getVariant(item, duty, width){
  const d = duty ? String(duty) : "";
  const w = (width === "" || width === null || width === undefined) ? "" : String(width);
  const key = `${d}|${w}`;
  return item.lookup?.[key] || null;
}

/* ---------- render ---------- */
function renderMachines(){
  const availableMachines = MACHINES.filter(m => CATEGORIES.some(c => c.machine === m));
  machineTabs.innerHTML = availableMachines.map(m => `
    <button class="${m===machine ? "active" : ""}" onclick="setMachine('${escAttr(m)}')">${m}</button>
  `).join("");
}

function renderCats(){
  const list = CATEGORIES.filter(c => c.machine === machine);
  catList.innerHTML = list.map(c => `
    <button class="catBtn ${category && category.id===c.id ? "active" : ""}" onclick="setCategory('${escAttr(c.id)}')">
      ${c.label}
    </button>
  `).join("");

  if (!list.length){
    catList.innerHTML = `<div class="small">No categories for this machine.</div>`;
  }
}

function makeTile(item){
  const duties = uniq(item?.options?.duty || []).filter(d => norm(d) !== "none");
  const widths = numericSort(item?.options?.width || []);

  // Always show Duty dropdown (even if 1 option) if duties exist
  const showDuty = duties.length > 0;

  // Defaults
  let selectedDuty = showDuty ? duties[0] : "";
  let selectedWidth = widths.length ? widths[0] : "";

  const tile = document.createElement("div");
  tile.className = "tile";

  tile.innerHTML = `
    <div class="tileHead">
      <div class="name">${escAttr(item?.name || "Item")}</div>
    </div>
    <div class="tileBody">
      <div class="filters">
        ${showDuty ? `
          <div class="field">
            <label>Duty</label>
            <select class="dutySel">
              ${duties.map(d => `<option value="${escAttr(d)}">${d}</option>`).join("")}
            </select>
          </div>
        ` : ""}
        <div class="field">
          <label>Width (in)</label>
          <select class="widthSel">
            ${widths.map(w => `<option value="${escAttr(w)}">${w}"</option>`).join("")}
          </select>
        </div>
      </div>

      <div>
        <div class="small">Selected SKU</div>
        <div class="skuOut" style="font-weight:900">â€”</div>
      </div>

      <div>
        <div class="small">Price</div>
        <div class="priceOut priceBig">â€”</div>
      </div>

      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <a class="btn btnPrimary emailBtn" href="#">Email Quote</a>
      </div>
    </div>
  `;

  const dutySel = tile.querySelector(".dutySel");
  const widthSel = tile.querySelector(".widthSel");
  const skuOut = tile.querySelector(".skuOut");
  const priceOut = tile.querySelector(".priceOut");
  const emailBtn = tile.querySelector(".emailBtn");

  function update(){
    const d = dutySel ? dutySel.value : "";
    const w = widthSel ? widthSel.value : "";
    const v = getVariant(item, d, w);

    skuOut.textContent = v?.sku || "â€”";
    priceOut.textContent = v ? money(v.price) : "â€”";

    const subject = encodeURIComponent(`Quote request: ${(item?.name || "Item")} ${v?.sku ? "(" + v.sku + ")" : ""}`);
    const body = encodeURIComponent(
      `Hi Hendo Equipment,\n\n` +
      `Iâ€™d like a quote for:\n` +
      `Category: ${category?.label || ""}\n` +
      `Item: ${item?.name || ""}\n` +
      (d ? `Duty: ${d}\n` : "") +
      (w ? `Width: ${w}"\n` : "") +
      (v?.sku ? `SKU: ${v.sku}\n` : "") +
      (v ? `Price shown: ${money(v.price)}\n` : "") +
      `\nName:\nPhone:\nLocation:\n\nThanks!`
    );
    emailBtn.href = `mailto:${QUOTE_EMAIL}?subject=${subject}&body=${body}`;
  }

  if (dutySel && selectedDuty) dutySel.value = selectedDuty;
  if (widthSel && selectedWidth !== "") widthSel.value = String(selectedWidth);

  if (dutySel) dutySel.addEventListener("change", update);
  if (widthSel) widthSel.addEventListener("change", update);

  update();
  return tile;
}

function renderTiles(){
  tilesEl.innerHTML = "";

  if (!category){
    categoryTitle.textContent = "Select a category";
    categoryHint.textContent = "Choose a machine + category. Then use duty + width dropdowns â€” price updates instantly.";
    statusEl.textContent = "";
    return;
  }

  categoryTitle.textContent = category.label;
  categoryHint.textContent = "Tiles below are loaded from the Excel-driven catalog (inline).";

  const items = Array.isArray(category.items) ? category.items : [];
  if (!items.length){
    tilesEl.innerHTML = `<div class="small">No items found in this category.</div>`;
    statusEl.textContent = "";
    return;
  }

  items.forEach(item => tilesEl.appendChild(makeTile(item)));
  statusEl.textContent = `Showing ${items.length} item${items.length===1?"":"s"}.`;
}

function render(){
  renderMachines();
  renderCats();
  renderTiles();
}

/* ---------- actions ---------- */
window.setMachine = function(m){
  machine = m;
  const catsForMachine = CATEGORIES.filter(c => c.machine === machine);
  category = catsForMachine[0] || null;
  try { localStorage.setItem("hendo_machine", machine); } catch(e){}
  render();
};

window.setCategory = function(id){
  category = CATEGORIES.find(c => c.id === id) || null;
  try { localStorage.setItem("hendo_category", category?.id || ""); } catch(e){}
  render();
};

/* ---------- init ---------- */
(function init(){
  // restore selections if possible
  let savedMachine = null;
  let savedCategory = null;
  try{
    savedMachine = localStorage.getItem("hendo_machine");
    savedCategory = localStorage.getItem("hendo_category");
  }catch(e){}

  const availableMachines = MACHINES.filter(m => CATEGORIES.some(c => c.machine === m));
  if (savedMachine && availableMachines.includes(savedMachine)) machine = savedMachine;

  const catsForMachine = CATEGORIES.filter(c => c.machine === machine);
  if (savedCategory && catsForMachine.some(c => c.id === savedCategory)){
    category = catsForMachine.find(c => c.id === savedCategory);
  } else {
    category = catsForMachine[0] || null;
  }

  if (!CATEGORIES.length){
    statusEl.textContent = "No catalog data found inline.";
  } else if (!category){
    statusEl.textContent = "Select a machine/category to view items.";
  } else {
    statusEl.textContent = "";
  }

  render();
})();
</script>
</body>
</html>
